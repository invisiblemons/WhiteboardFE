<p-dialog
  header="Chi tiết trường đại học"
  [draggable]="false"
  [modal]="true"
  [style]="{ width: '70vw' }"
  [closable]="true"
  [(visible)]="displayBasic"
  (onHide)="onDiscard()"
>
  <div *ngIf="!this.university" style="margin-left: 50%">
    <p-progressSpinner
      [style]="{ width: '50px', height: '50px' }"
      styleClass="custom-spinner"
      strokeWidth="8"
      fill="#EEEEEE"
      animationDuration=".5s"
    ></p-progressSpinner>
  </div>
  <div *ngIf="this.university">
    <!-- detail campaign -->
    <div class="row">
      <div class="col-sm-12">
        <app-card [headerContent]="'Thông tin chi tiết trường đại học'">
          <div class="row">
            <div class="col-sm-12 col-xl-6">
              <h4 class="sub-title" style="font-weight: 600">Logo trường đại học</h4>
              <div class="card">
                <div class="profile-wrap animated">
                  <img
                    style="width: 600px; height: 300px"
                    src="{{ imageLogo }}"
                  />
                </div>
              </div>
            </div>
            <div class="col-sm-12 col-xl-6">
              <h4 class="sub-title" style="font-weight: 600">
                Thông tin
              </h4>
              <dl class="dl-horizontal row">
                <dt class="col-sm-3">Tên trường đại học</dt>
                <dd class="col-sm-9">
                  {{ university.name }}
                </dd>
                <dt class="col-sm-3">Email</dt>

                <dd class="col-sm-9 col-sm-offset-3">
                  {{ university.email }}
                </dd>
                <dt class="col-sm-3">Số điện thoại</dt>
                <dd class="col-sm-9">
                  {{ university.phoneNumber}}
                </dd>
              </dl>
            </div>
          </div>
        </app-card>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12">
        <app-card [headerContent]="'Quản lý Campus thuộc trường đại học'">
          <div class="row">
            <div class="col-sm-12 col-xl-12">
              <h4 class="sub-title" style="font-weight: 600">
                Quản lý Campus thuộc trường đại học
              </h4>
              <p-table [value]="campuses" dataKey="id">
                <ng-template pTemplate="header">
                  <tr>
                    <th style="width: 3rem" class="text-center"></th>
                    <th pSortableColumn="name">
                      Tên campus<p-sortIcon field="name"></p-sortIcon>
                    </th>
                    <th class="text-center">Logo</th>
                    <th class="text-center">
                      Địa chỉ
                    </th>
                    <th class="text-center">
                        Email
                      </th>
                      <th class="text-center">
                        Số điện thoại
                      </th>
                    <th style="width: 5rem"></th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-campus>
                  <tr>
                    <td>
                        <button
                          type="button"
                          pButton
                          pRipple
                          (click)="openCampusesOfUniversity(campus)"
                          [pRowToggler]="campus"
                          class="p-button-text p-button-rounded p-button-plain"
                          [icon]="
                            expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'
                          "
                        ></button>
                      </td>
                    <td class="text-center">{{ campus.name }}</td>
                    <td class="text-center">{{ campus.image }}</td>
                    <td class="text-center">{{ campus.address }}</td>
                    <td class="text-center">{{ campus.email }}</td>
                    <td class="text-center">{{ campus.phoneAddress }}</td>
                    <td>
                      <button
                        pButton
                        pRipple
                        icon="pi pi-pencil"
                        class="p-button-rounded p-button-success p-mr-2"
                        style="margin-right: 5px"
                        (click)="editCampus(campus)"
                      ></button>
                      <button
                        pButton
                        pRipple
                        icon="pi pi-trash"
                        class="p-button-rounded p-button-warning"
                        (click)="deleteCampus(campus)"
                      ></button>
                    </td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                  <tr>
                    <td></td>
                    <td colspan="6">Trường đại học này không có campus.</td>
                  </tr>
                </ng-template>
                <ng-template pTemplate="rowexpansion" let-campus>
                    <tr>
                      <td colspan="4">
                        <div class="p-p-3">
                          <p-table [value]="majorsOfCampus" dataKey="code">
                            <ng-template pTemplate="header">
                              <tr>
                                <th pSortableColumn="code" class="text-center">
                                    >Mã môn học <p-sortIcon field="code"></p-sortIcon>
                                </th>
                                <th class="text-center">Name</th>
                                <th style="width: 5rem"></th>
                              </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-majorOfCampus>
                              <tr>
                                <td class="text-center">{{ majorOfCampus.code }}</td>
                                <td class="text-center">{{ majorOfCampus.name }}</td>
                                <td>
                                    <button
                                      pButton
                                      pRipple
                                      icon="pi pi-pencil"
                                      class="p-button-rounded p-button-success p-mr-2"
                                      style="margin-right: 5px"
                                      (click)="editMajor(majorOfCampus)"
                                    ></button>
                                    <button
                                      pButton
                                      pRipple
                                      icon="pi pi-trash"
                                      class="p-button-rounded p-button-warning"
                                      (click)="deleteMajor(majorOfCampus)"
                                    ></button>
                                  </td>
                              </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                              <tr>
                                <td colspan="3">
                                  Không có môn nào ở campus này.
                                </td>
                              </tr>
                            </ng-template>
                          </p-table>
                        </div>
                      </td>
                    </tr>
                  </ng-template>
              </p-table>
            </div>
          </div>
        </app-card>
      </div>
    </div>
  </div>

  <!-- campus modal -->
  <p-dialog
    [(visible)]="campusDialog"
    [style]="{ width: '350px' }"
    header="Thông tin campus"
    [modal]="true"
    styleClass="p-fluid"
  >
    <ng-template pTemplate="content">
      <div class="p-field">
        <label for="name">Tên campus</label>
        <input
          type="text"
          pInputText
          id="name"
          [(ngModel)]="campus.name"
          required
          autofocus
        />
      </div>
      <div class="p-field">
      <label for="address">Địa chỉ</label>
        <input
          type="text"
          pInputText
          id="address"
          [(ngModel)]="campus.address"
          required
          autofocus
        />
    </div>
    <div class="p-field">
      <label for="email">Email</label>
        <input
          type="text"
          pInputText
          id="email"
          [(ngModel)]="campus.email"
          required
          autofocus
        />
      </div>
      <div class="p-field mt-3">
        <label for="image">Logo campus</label>
        <form
          [formGroup]="formTemplate"
          (submit)="onSubmit(formTemplate.value)"
        >
          <div class="text-center">
            <img
              [src]="imgSrc"
              width="350px"
              height="250px"
              (click)="fileUploader.click()"
            />
          </div>
          <div class="form-group">
            <input
              type="file"
              accept="image/*"
              class="form-control"
              #fileUploader
              formControlName="imageUrl"
              (change)="showPreview($event)"
            />
          </div>
        </form>
      </div>
    </ng-template>

    <ng-template pTemplate="footer">
      <button
        pButton
        pRipple
        label="Cancel"
        icon="pi pi-times"
        class="p-button-text"
        (click)="hideCampusDialog()"
      ></button>
      <button
        pButton
        pRipple
        label="Save"
        icon="pi pi-check"
        class="p-button-text"
        (click)="saveCampus()"
      ></button>
    </ng-template>
  </p-dialog>

  <!-- major modal -->
  <p-dialog
    [(visible)]="majorDialog"
    [style]="{ width: '350px' }"
    header="Thông tin campus"
    [modal]="true"
    styleClass="p-fluid"
  >
    <ng-template pTemplate="content">
        <div class="p-field">
            <label for="code">Mã môn học</label>
              <input
                type="text"
                pInputText
                id="code"
                [(ngModel)]="major.code"
                required
                autofocus
              />
          </div>
      <div class="p-field">
        <label for="name">Tên ngành</label>
        <input
          type="text"
          pInputText
          id="name"
          [(ngModel)]="major.name"
          required
          autofocus
        />
      </div>
    
    </ng-template>

    <ng-template pTemplate="footer">
      <button
        pButton
        pRipple
        label="Cancel"
        icon="pi pi-times"
        class="p-button-text"
        (click)="hideMajorDialog()"
      ></button>
      <button
        pButton
        pRipple
        label="Save"
        icon="pi pi-check"
        class="p-button-text"
        (click)="saveMajor()"
      ></button>
    </ng-template>
  </p-dialog>

</p-dialog>
